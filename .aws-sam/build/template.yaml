AWSTemplateFormatVersion: 2010-09-09
Transform: 'AWS::Serverless-2016-10-31'
Description: |
  eventbridge-ts
  Sample SAM Template for eventbridge-ts
Globals:
  Function:
    Timeout: 3
Resources:
  ProducerFn:
    Type: 'AWS::Serverless::Function'
    Properties:
      CodeUri: ProducerFn
      Handler: app.lambdaHandler
      Runtime: nodejs10.x
      Events:
        ApiEvent:
          Type: Api
          Properties:
            Path: /remoteLock
            Method: post
            RequestParameters:
              - method.request.querystring.action
              - method.request.querystring.id
      Policies:
        - Statement:
            - Effect: Allow
              Resource: '*'
              Action:
                - 'events:PutEvents'
  ConsumerFn:
    Type: 'AWS::Serverless::Function'
    Properties:
      CodeUri: ConsumerFn
      Handler: app.lambdaHandler
      Runtime: nodejs10.x
      Events:
        Trigger:
          Type: CloudWatchEvent
          Properties:
            Pattern:
              source:
                - custom.remoteLock
              detail-type:
                - lockOperation
